name: Deploy a cPanel

on:
  push:
    branches:
      - main  # O la rama que uses para producción

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Desplegar vía SSH
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SSH_HOST }}      # IP de tu servidor o dominio
          username: ${{ secrets.SSH_USER }}  # Tu usuario de cPanel
          key: ${{ secrets.SSH_PRIVATE_KEY }} # La llave que guardamos antes
          port: 22                            # Puerto SSH (suele ser 22 o 2222)
          script: |
            cd /home2/teleredt/public_html/novelasia.teleredtv.com/proyecto
            git pull origin main
            composer install --no-interaction --prefer-dist --optimize-autoloader
            php artisan optimize:clear
            # Si usas React y necesitas compilar en el servidor:
            npm install
            npm run build